import{r as N,m as L,j as e,L as D,$ as b}from"./app-YqAKXmx4.js";import{B as p}from"./app-logo-icon-C5772xde.js";import{u as F,C as h}from"./use-breadcrumbs-CoInKs1f.js";import{C as U}from"./checkbox-zjPv0-B3.js";import{I as d}from"./input-DWdhC-1c.js";import{L as o}from"./label-BWnNFlfB.js";import{A as $}from"./app-layout-BmMVWIgb.js";import{A as R}from"./arrow-left-DS8MzjM4.js";import{E as g}from"./eye-off-C1qPQeAl.js";import{E as v}from"./eye-BFfpOHmc.js";import{S as P}from"./save-BlvJSWtf.js";import{C as B}from"./circle-alert-Bm3V8IU3.js";import"./index-BddAxOEG.js";import"./index-1v4zfmRw.js";import"./check-Bu4zrn9Y.js";function Z({user:r,roles:y}){var u;const{adminBreadcrumbs:w}=F(),C=w.users.edit(),[n,E]=N.useState(!1),[c,k]=N.useState(!1),{data:t,setData:i,put:_,processing:j,errors:a}=L({name:r.name,email:r.email,password:"",password_confirmation:"",roles:((u=r.roles)==null?void 0:u.map(s=>s.id))||[]}),S=s=>{s.preventDefault(),_(`/admin/users/${r.id}`,{onSuccess:()=>{i(l=>({...l,password:"",password_confirmation:""}))}})},A=(s,l)=>{l?i("roles",[...t.roles,s]):i("roles",t.roles.filter(m=>m!==s))};return e.jsxs($,{breadcrumbs:C,children:[e.jsx(D,{title:`Editar Usuario: ${r.name}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:["Editar Usuario: ",r.name]}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica la información del usuario y sus roles"})]}),e.jsx(b,{href:"/admin/users",children:e.jsxs(p,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:"Volver a Lista"})]})})]}),e.jsx(h,{className:"p-4 bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"mt-1 px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-mono text-gray-900 dark:text-gray-100",children:r.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-blue-900",children:["Usuario ID: ",r.id]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Registrado el: ",new Date(r.created_at).toLocaleDateString("es-ES")]}),r.email_verified_at&&e.jsx("p",{className:"text-xs text-green-700",children:"✓ Email verificado"})]})]})}),e.jsx(h,{className:"p-6",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"name",children:["Nombre Completo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{id:"name",type:"text",value:t.name,onChange:s=>i("name",s.target.value),placeholder:"Ej: Juan Pérez",className:a.name?"border-red-500":""}),a.name&&e.jsx("p",{className:"text-sm text-red-600",children:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"email",children:["Correo Electrónico ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{id:"email",type:"email",value:t.email,onChange:s=>i("email",s.target.value),placeholder:"Ej: juan@ejemplo.com",className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-sm text-red-600",children:a.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"password",children:["Nueva Contraseña ",e.jsx("span",{className:"text-gray-500",children:"(Opcional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password",type:n?"text":"password",value:t.password,onChange:s=>i("password",s.target.value),placeholder:"Dejar vacío para mantener actual",className:a.password?"border-red-500 pr-10":"pr-10"}),e.jsx("button",{type:"button",onClick:()=>E(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(g,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]}),a.password&&e.jsx("p",{className:"text-sm text-red-600",children:a.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"password_confirmation",children:"Confirmar Nueva Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password_confirmation",type:c?"text":"password",value:t.password_confirmation,onChange:s=>i("password_confirmation",s.target.value),placeholder:"Repetir nueva contraseña",className:a.password_confirmation?"border-red-500 pr-10":"pr-10"}),e.jsx("button",{type:"button",onClick:()=>k(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(g,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})})]}),a.password_confirmation&&e.jsx("p",{className:"text-sm text-red-600",children:a.password_confirmation})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(o,{className:"text-base font-medium",children:["Roles del Usuario ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Selecciona los roles que tendrá este usuario"})]}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:y.map(s=>{var f;const l=t.roles.includes(s.id),m=(f=r.roles)==null?void 0:f.some(x=>x.id===s.id);return e.jsxs("div",{className:`flex items-start space-x-3 p-3 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${l?"border-blue-200":""}`,children:[e.jsx(U,{id:`role-${s.id}`,checked:l,onCheckedChange:x=>A(s.id,x)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:`role-${s.id}`,className:"text-sm font-medium cursor-pointer flex items-center space-x-2",children:[e.jsx("span",{children:s.display_name}),m&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:"Actual"})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:s.description})]})]},s.id)})}),a.roles&&e.jsx("p",{className:"text-sm text-red-600",children:a.roles})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[e.jsx(b,{href:"/admin/users",children:e.jsx(p,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(p,{type:"submit",disabled:j,className:"flex items-center space-x-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Actualizando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:"Actualizar Usuario"})]})})]})]})}),e.jsx(h,{className:"p-4 bg-amber-50 border-amber-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(B,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-amber-900",children:"Consideraciones importantes"}),e.jsxs("ul",{className:"text-sm text-amber-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Deja las contraseñas vacías si no quieres cambiarlas"}),e.jsx("li",{children:"• Los cambios de roles toman efecto inmediatamente"}),e.jsx("li",{children:"• El usuario será notificado por email sobre cambios importantes"}),e.jsx("li",{children:"• No puedes eliminar todos los roles de un usuario"})]})]})]})})]})]})}export{Z as default};
